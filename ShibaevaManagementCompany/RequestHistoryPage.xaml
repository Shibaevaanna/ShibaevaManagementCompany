<Page x:Class="ShibaevaManagementCompany.RequestHistoryPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="История выполнения заявок">

    <Grid Background="White" Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="История выполнения заявок" 
                       FontSize="24" FontWeight="Bold" 
                       FontFamily="Segoe UI"/>
            <TextBlock Text="Просмотр истории заявок по сотрудникам и адресам" 
                       FontSize="14" FontFamily="Segoe UI" 
                       Foreground="#666666" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Filters -->
        <Border Grid.Row="1" Background="#F4E8D3" Padding="15" CornerRadius="5" Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Filter by Employee -->
                <StackPanel Grid.Column="0">
                    <Label Content="Фильтр по сотруднику:" FontWeight="Bold"/>
                    <ComboBox Name="EmployeeFilterComboBox" Width="200" Height="35" Margin="0,5,10,0"
                              SelectionChanged="Filter_SelectionChanged">
                        <ComboBoxItem Content="Все сотрудники"/>
                        <ComboBoxItem Content="Смирнов Петр Иванович"/>
                        <ComboBoxItem Content="Кузнецов Алексей Владимирович"/>
                        <ComboBoxItem Content="Николаев Сергей Михайлович"/>
                        <ComboBoxItem Content="Васильев Игорь Константинович"/>
                    </ComboBox>
                </StackPanel>

                <!-- Filter by Address -->
                <StackPanel Grid.Column="2" Margin="20,0,0,0">
                    <Label Content="Фильтр по адресу:" FontWeight="Bold"/>
                    <ComboBox Name="AddressFilterComboBox" Width="200" Height="35" Margin="0,5,10,0"
                              SelectionChanged="Filter_SelectionChanged">
                        <ComboBoxItem Content="Все адреса"/>
                        <ComboBoxItem Content="ул. Ленина, д. 10"/>
                        <ComboBoxItem Content="ул. Пушкина, д. 25"/>
                        <ComboBoxItem Content="пр. Мира, д. 15"/>
                        <ComboBoxItem Content="ул. Гагарина, д. 8"/>
                    </ComboBox>
                </StackPanel>

                <!-- Date Range -->
                <StackPanel Grid.Column="4" Margin="20,0,0,0">
                    <Label Content="Период:" FontWeight="Bold"/>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <DatePicker Name="StartDatePicker" Width="120" Height="35" 
                                    SelectedDateChanged="DatePicker_Changed"/>
                        <TextBlock Text=" - " VerticalAlignment="Center" Margin="5,0"/>
                        <DatePicker Name="EndDatePicker" Width="120" Height="35" 
                                    SelectedDateChanged="DatePicker_Changed"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Statistics -->
        <Border Grid.Row="2" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="5" Padding="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Stats Header -->
                <Border Grid.Row="0" Background="#F9F9F9" Padding="10" CornerRadius="5" Margin="0,0,0,10">
                    <TextBlock Name="StatsTextBlock" Text="Общая статистика по заявкам" 
                               FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                </Border>

                <!-- Data Grid -->
                <DataGrid Grid.Row="1" Name="HistoryDataGrid" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID заявки" Binding="{Binding RequestId}" Width="80"/>
                        <DataGridTextColumn Header="Адрес" Binding="{Binding Address}" Width="200"/>
                        <DataGridTextColumn Header="Исполнитель" Binding="{Binding Employee}" Width="180"/>
                        <DataGridTextColumn Header="Статус" Binding="{Binding Status}" Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                    <Setter Property="Padding" Value="5"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Status}" Value="Выполнена">
                                            <Setter Property="Background" Value="#2ECC71"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Отменена">
                                            <Setter Property="Background" Value="#E74C3C"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Дата начала" Binding="{Binding StartDate}" Width="120"/>
                        <DataGridTextColumn Header="Дата завершения" Binding="{Binding EndDate}" Width="120"/>
                        <DataGridTextColumn Header="Длительность (дней)" Binding="{Binding Duration}" Width="120"/>
                        <DataGridTextColumn Header="Оценка клиента" Binding="{Binding Rating}" Width="100"/>
                        <DataGridTextColumn Header="Комментарий" Binding="{Binding Comment}" Width="250"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>
    </Grid>
</Page>